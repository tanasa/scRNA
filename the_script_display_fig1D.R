#####################################################################################################################################
#####################################################################################################################################
#####################################################################################################################################
#####################################################################################################################################
#####################################################################################################################################
#####################################################################################################################################

#set.seed(423)

#library(Cairo)
#options(bitmapType='cairo')
#library(sf)
#library(rgl)
#library(patchwork)

#library(monocle3)
#library(plotly)

#library(ggplot2)
#library(dplyr)
#library(edgeR)

#library(Seurat)
#library(SeuratData)
#library(SeuratWrappers)

#library(conos)
#library(liger)
#library(harmony)

#library(cowplot)
#library(Matrix)
#library(gridExtra)

#library(stringr)
#library(magrittr)
#library(dplyr)
#library(purrr)

#library(future)
#library(future.apply)

#library(data.table)
#library(vroom)
#library(tidyverse)

#plan("multiprocess", workers = 8)
#options(future.globals.maxSize = 64000 * 1024^2)

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
#####################################################################################################################################
#####################################################################################################################################
#####################################################################################################################################
#####################################################################################################################################
#####################################################################################################################################
#####################################################################################################################################
##################################################################################################################################### ### STARTING the CODE for the FIGURE 1D
#####################################################################################################################################
#####################################################################################################################################
#####################################################################################################################################
#####################################################################################################################################
#####################################################################################################################################
#####################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################

# z1 <- TSNEPlot(samples.combined.list.combined, group.by = "orig.ident")
# plot_grid(z1)
# ggsave(paste("figure1D.sui.TSNE.Plot", "assay.INTEGRATED.display.plot.TSNEplot", "png", sep="."), width = 20, height = 20, units = "cm")

# z2 <- UMAPPlot(samples.combined.list.combined, group.by = "orig.ident" )
# plot_grid(z2)
# ggsave(paste("figure1D.sui.UMAP.Plot", "assay.INTEGRATED.display.plot.UMAPplot", "png", sep="."), width = 20, height = 20, units = "cm")

# z3 <- PCAPlot(samples.combined.list.combined, group.by = "orig.ident")
# plot_grid(z3)
# ggsave(paste("figure1D.sui.PCA.Plot", "assay.INTEGRATED.display.plot.PCAplot", "png", sep="."), width = 20, height = 20, units = "cm")

# unique(samples.combined.list.combined@meta.data$orig.ident)

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
Idents(samples.combined.list.combined) <- "integrated_snn_res.0.4"
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##################################################################################
##################################################################################
################################################################################## label = TRUE, label.size = 3, 
################################################################################## also on Figure 1A, just to dissociate the plots :::
##################################################################################
##################################################################################
##################################################################################

SET_3_COLORS = c("red", "white", "white", "white", "white", "darkgreen", "white", "white", "white", "white") ### changing it depending on the MONTH
MONTH = "1M"

##################################################################################
##################################################################################

# Visualization using TSNE :
#p1 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident", cols = SET_3_COLORS, pt.size=0.001)
#plot_grid(p1)
#ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part1", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using TSNE :
#p2 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.10)
#plot_grid(p2)
#ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part2", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using TSNE :
p3 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.010)
plot_grid(p3)
ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part3", "png", sep="."), width = 20, height = 20, units = "cm")

##################################################################################
##################################################################################
# Visualization using UMAP :
#p1 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident", cols = SET_3_COLORS, pt.size=0.001)
#plot_grid(p1)
#ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part1", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using UMAP :
#p2 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.10)
#plot_grid(p2)
#ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part2", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using UMAP :
p3 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.010)
plot_grid(p3)
ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part3", "png", sep="."), width = 20, height = 20, units = "cm")

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################

SET_3_COLORS = c("white", "red", "white", "white", "white", "white", "darkgreen", "white", "white", "white") ### changing it depending on the MONTH
MONTH = "2M"

##################################################################################
##################################################################################

# Visualization using TSNE :
# p1 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident", cols = SET_3_COLORS, pt.size=0.001)
# plot_grid(p1)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part1", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using TSNE :
# p2 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.10)
# plot_grid(p2)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part2", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using TSNE :
p3 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.010)
plot_grid(p3)
ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part3", "png", sep="."), width = 20, height = 20, units = "cm")

##################################################################################
##################################################################################
# Visualization using UMAP :
# p1 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident", cols = SET_3_COLORS, pt.size=0.001)
# plot_grid(p1)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part1", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using UMAP :
# p2 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.10)
# plot_grid(p2)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part2", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using UMAP :
p3 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.010)
plot_grid(p3)
ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part3", "png", sep="."), width = 20, height = 20, units = "cm")

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################

SET_3_COLORS = c("white", "white", "red", "white", "white", "white", "white", "darkgreen", "white", "white") ### changing it depending on the MONTH
MONTH = "3M"

##################################################################################
##################################################################################

# Visualization using TSNE :
# p1 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident", cols = SET_3_COLORS, pt.size=0.001)
# plot_grid(p1)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part1", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using TSNE :
# p2 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.10)
# plot_grid(p2)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part2", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using TSNE :
p3 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.010)
plot_grid(p3)
ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part3", "png", sep="."), width = 20, height = 20, units = "cm")

##################################################################################
##################################################################################
# Visualization using UMAP :
# p1 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident", cols = SET_3_COLORS, pt.size=0.001)
# plot_grid(p1)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part1", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using UMAP :
# p2 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.10)
# plot_grid(p2)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part2", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using UMAP :
p3 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.010)
plot_grid(p3)
ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part3", "png", sep="."), width = 20, height = 20, units = "cm")

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################

SET_3_COLORS = c("white", "white", "white", "red", "white", "white", "white", "white", "darkgreen", "white") ### changing it depending on the MONTH
MONTH = "4M"

##################################################################################
##################################################################################

# Visualization using TSNE :
# p1 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident", cols = SET_3_COLORS, pt.size=0.001)
# plot_grid(p1)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part1", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using TSNE :
# p2 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.10)
# plot_grid(p2)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part2", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using TSNE :
p3 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.010)
plot_grid(p3)
ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part3", "png", sep="."), width = 20, height = 20, units = "cm")

##################################################################################
##################################################################################
# Visualization using UMAP :
# p1 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident", cols = SET_3_COLORS, pt.size=0.001)
# plot_grid(p1)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part1", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using UMAP :
# p2 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.10)
# plot_grid(p2)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part2", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using UMAP :
p3 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.010)
plot_grid(p3)
ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part3", "png", sep="."), width = 20, height = 20, units = "cm")

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################

SET_3_COLORS = c("white", "white", "white", "white", "red", "white", "white", "white", "white", "darkgreen") ### changing it depending on the MONTH
MONTH = "5M"

##################################################################################
##################################################################################

# Visualization using TSNE :
# p1 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident", cols = SET_3_COLORS, pt.size=0.001)
# plot_grid(p1)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part1", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using TSNE :
# p2 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.10)
# plot_grid(p2)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part2", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using TSNE :
p3 <- DimPlot(samples.combined.list.combined, reduction = "tsne", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.010)
plot_grid(p3)
ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.TSNE.part3", "png", sep="."), width = 20, height = 20, units = "cm")

##################################################################################
##################################################################################
# Visualization using UMAP :
# p1 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident", cols = SET_3_COLORS, pt.size=0.001)
# plot_grid(p1)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part1", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using UMAP :
# p2 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.10)
# plot_grid(p2)
# ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part2", "png", sep="."), width = 20, height = 20, units = "cm")

# Visualization using UMAP :
p3 <- DimPlot(samples.combined.list.combined, reduction = "umap", group.by = "orig.ident",  cols = SET_3_COLORS, pt.size=0.010)
plot_grid(p3)
ggsave(paste("figure1D.sui.Dim.Plot", "MONTH", MONTH, "assay.INTEGRATED.display.UMAP.part3", "png", sep="."), width = 20, height = 20, units = "cm")

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
### in order to get the TIME.POINT

library(purrr)
x = samples.combined.list.combined@meta.data
m = strsplit(x$orig.ident, '[.]')
n = unlist(map(m, 2))
x$TIME = n

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################

write.table(as.data.frame(x), file = "fig1D.the.dataframe.for.verification.TIME.POINT.txt", 
                              sep="\t", quote=FALSE, row.names = TRUE, col.names = TRUE)

samples.combined.list.combined@meta.data$TIME = x$TIME

head(samples.combined.list.combined@meta.data)
tail(samples.combined.list.combined@meta.data)

write.table(as.data.frame(samples.combined.list.combined@meta.data), 
                              file = "fig1D.the.dataframe.for.verification.TIME.POINT.meta.data.txt", 
                              sep="\t", quote=FALSE, row.names = TRUE, col.names = TRUE)

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
### to see if the UMAP or TSNE embeddings are preserved !!!!!!!!!!!!!!!!!!!!!!!!!!!!
### i believe that the UMAP EMBEDDINGS are kept during the SUBSETTING per TIME POINT !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! UMAP embeddings !!!!!!!!!!!!!!!!!!!!!!!!!!!!

M1 = subset(x = samples.combined.list.combined, subset = (TIME == "1M") ) 
M2 = subset(x = samples.combined.list.combined, subset = (TIME == "2M") ) 
M3 = subset(x = samples.combined.list.combined, subset = (TIME == "3M") )
M4 = subset(x = samples.combined.list.combined, subset = (TIME == "4M") ) 
M5 = subset(x = samples.combined.list.combined, subset = (TIME == "5M") )

head(M1@meta.data)
head(M2@meta.data)
head(M3@meta.data)
head(M4@meta.data)
head(M5@meta.data)

tail(M1@meta.data)
tail(M2@meta.data)
tail(M3@meta.data)
tail(M4@meta.data)
tail(M5@meta.data)

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################

Idents(M1) <- "orig.ident"
unique(M1@meta.data$disease)
unique(M1@meta.data$orig.ident)

Idents(M2) <- "orig.ident"
unique(M2@meta.data$disease)
unique(M2@meta.data$orig.ident)

Idents(M3) <- "orig.ident"
unique(M3@meta.data$disease)
unique(M3@meta.data$orig.ident)

Idents(M4) <- "orig.ident"
unique(M4@meta.data$disease)
unique(M4@meta.data$orig.ident)

Idents(M5) <- "orig.ident"
unique(M5@meta.data$disease)
unique(M5@meta.data$orig.ident)

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
### display TSNE and UMAP for each MONTH : M1

p1 = DimPlot(M1, reduction = "tsne", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p2 = DimPlot(M1, reduction = "tsne", group.by = "seurat_clusters", label=TRUE, pt.size=0.010)
plot_grid(p1, p2)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "TSNE", "M1", "png", sep="."), width = 40, height = 20, units = "cm")

p1 = DimPlot(M1, reduction = "umap", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p2 = DimPlot(M1, reduction = "umap", group.by = "seurat_clusters", label=TRUE, pt.size=0.010)
plot_grid(p1, p2)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "UMAP", "M1", "png", sep="."), width = 40, height = 20, units = "cm")

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
### display TSNE and UMAP for each MONTH : M2

p1 = DimPlot(M2, reduction = "tsne", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p2 = DimPlot(M2, reduction = "tsne", group.by = "seurat_clusters", label=TRUE, pt.size=0.010)
plot_grid(p1, p2)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "TSNE", "M2", "png", sep="."), width = 40, height = 20, units = "cm")

p1 = DimPlot(M2, reduction = "umap", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p2 = DimPlot(M2, reduction = "umap", group.by = "seurat_clusters", label=TRUE, pt.size=0.010)
plot_grid(p1, p2)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "UMAP", "M2", "png", sep="."), width = 40, height = 20, units = "cm")

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
### display TSNE and UMAP for each MONTH : M3

p1 = DimPlot(M3, reduction = "tsne", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p2 = DimPlot(M3, reduction = "tsne", group.by = "seurat_clusters", label=TRUE, pt.size=0.010)
plot_grid(p1, p2)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "TSNE", "M3", "png", sep="."), width = 40, height = 20, units = "cm")

p1 = DimPlot(M3, reduction = "umap", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p2 = DimPlot(M3, reduction = "umap", group.by = "seurat_clusters", label=TRUE, pt.size=0.010)
plot_grid(p1, p2)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "UMAP", "M3", "png", sep="."), width = 40, height = 20, units = "cm")

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
### display TSNE and UMAP for each MONTH : M4

p1 = DimPlot(M4, reduction = "tsne", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p2 = DimPlot(M4, reduction = "tsne", group.by = "seurat_clusters", label=TRUE, pt.size=0.010)
plot_grid(p1, p2)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "TSNE", "M4", "png", sep="."), width = 40, height = 20, units = "cm")

p1 = DimPlot(M4, reduction = "umap", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p2 = DimPlot(M4, reduction = "umap", group.by = "seurat_clusters", label=TRUE, pt.size=0.010)
plot_grid(p1, p2)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "UMAP", "M4", "png", sep="."), width = 40, height = 20, units = "cm")

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
### display TSNE and UMAP for each MONTH : M5

p1 = DimPlot(M5, reduction = "tsne", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p2 = DimPlot(M5, reduction = "tsne", group.by = "seurat_clusters", label=TRUE, pt.size=0.010)
plot_grid(p1, p2)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "TSNE", "M5", "png", sep="."), width = 40, height = 20, units = "cm")

p1 = DimPlot(M5, reduction = "umap", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p2 = DimPlot(M5, reduction = "umap", group.by = "seurat_clusters", label=TRUE, pt.size=0.010)
plot_grid(p1, p2)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "UMAP", "M5", "png", sep="."), width = 40, height = 20, units = "cm")

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################

p1 = DimPlot(M1, reduction = "umap", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p2 = DimPlot(M2, reduction = "umap", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p3 = DimPlot(M3, reduction = "umap", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p4 = DimPlot(M4, reduction = "umap", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)
p5 = DimPlot(M5, reduction = "umap", group.by = "orig.ident",  cols = c("red", "darkgreen"), pt.size=0.010)

plot_grid(p1, p2, p3, p4, p5)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "UMAP", "M1.M2.M3.M4.M4.M5", "png", sep="."), width = 180, height = 80, units = "cm")

##########################################################################################################################################################################################################################################################################

plot_grid(p1)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "UMAP", "M1", "v2", "png", sep="."), width = 20, height = 20, units = "cm")

plot_grid(p2)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "UMAP", "M2", "v2", "png", sep="."), width = 20, height = 20, units = "cm")

plot_grid(p3)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "UMAP", "M3", "v2", "png", sep="."), width = 20, height = 20, units = "cm")

plot_grid(p4)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "UMAP", "M4", "v2", "png", sep="."), width = 20, height = 20, units = "cm")

plot_grid(p5)
ggsave(paste("figure1D.sui.Dim.Plot", "orig.ident.seurat_clusters", "UMAP", "M5", "v2", "png", sep="."), width = 20, height = 20, units = "cm")

##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
##########################################################################################################################################################################################################################################################################
